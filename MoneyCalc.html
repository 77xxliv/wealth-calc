<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>ä¸ªäººè´¢åŠ¡è®¡ç®—é¢æ¿ï¼ˆä¸Šæµ· 2025ï¼‰</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
body {font-family:"å¾®è½¯é›…é»‘",Arial,sans-serif;background:#f5f6fa;margin:0;}
.container {max-width:560px;margin:20px auto;background:#fff;padding:20px;border-radius:12px;box-shadow:0 2px 10px rgba(0,0,0,0.05);}
.tabs {display:flex;border-bottom:2px solid #eee;margin-bottom:14px;}
.tab {flex:1;text-align:center;padding:10px 0;cursor:pointer;font-weight:bold;font-size:14px;color:#555;transition:all 0.2s;}
.tab.active {color:#1976d2;border-bottom:2px solid #1976d2;}
.tool {display:none;}
.tool.active {display:block;}
label {display:block;margin:12px 0 4px;font-weight:bold;font-size:13px;}
input,select {padding:6px 8px;font-size:14px;width:100%;box-sizing:border-box;border:1px solid #ccc;border-radius:6px;outline:none;transition:border-color 0.2s;}
input:focus,select:focus {border-color:#1976d2;}
button {margin-top:15px;padding:8px 20px;font-size:14px;background:#1976d2;color:#fff;border:none;border-radius:20px;cursor:pointer;transition:background 0.2s;}
button:hover {background:#145ea8;}
.result {margin-top:16px;padding-top:12px;border-top:1px dashed #ccc;}
.sum {font-size:18px;color:#e8711f;font-weight:bold;}
.tip {font-size:12px;color:#888;}
.settings-panel {background:#fafafa;padding:10px;border:1px solid #ddd;border-radius:8px;margin-top:10px;display:none;animation:fadeIn 0.3s;}
@keyframes fadeIn {from{opacity:0;}to{opacity:1;}}
.icon-btn {background:#1976d2;border:none;cursor:pointer;vertical-align:middle;padding:6px;margin-left:8px;border-radius:50%;display:inline-flex;align-items:center;justify-content:center;transition:background 0.2s;}
.icon-btn svg {width:18px;height:18px;fill:#fff;transition:transform 0.3s;}
.icon-btn:hover {background:#145ea8;}
.icon-btn:hover svg {transform:rotate(180deg);}
</style>
</head>
<body>
<div class="container">

  <!-- å…¨å±€å·¥èµ„ & å‚æ•°è®¾ç½® -->
  <label>å…¨å±€æœˆå·¥èµ„ï¼ˆå…ƒï¼‰ï¼š</label>
  <input type="number" id="global_salary" value="20000" step="50">
  <button id="toggle-settings">æ‰“å¼€å‚æ•°è®¾ç½®</button>
  <button id="clear-data" class="icon-btn" title="æ¢å¤é»˜è®¤å€¼">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
      <path d="M17.65 6.35A7.95 7.95 0 0 0 12 4V1L7 6l5 5V8c2.76 0 5 2.24 5 5 0 1.3-.5 2.48-1.35 3.35l1.45 1.45A7.952 7.952 0 0 0 20 13c0-2.21-.9-4.21-2.35-5.65zM6.35 17.65A7.95 7.95 0 0 0 12 20v3l5-5-5-5v3c-2.76 0-5-2.24-5-5 0-1.3.5-2.48 1.35-3.35L6.9 6.9A7.952 7.952 0 0 0 4 11c0 2.21.9 4.21 2.35 5.65z"/>
    </svg>
  </button>

  <div class="settings-panel" id="settings-panel">
    <label>å…¬ç§¯é‡‘æ¯”ä¾‹ï¼ˆå•ä½/ä¸ªäººï¼Œ%ï¼‰ï¼š</label>
    <input type="number" id="param_gjj_rate" value="12">
    <label>å…¬ç§¯é‡‘åŸºæ•°ä¸‹é™ï¼š</label>
    <input type="number" id="param_gjj_base_min" value="7460">
    <label>å…¬ç§¯é‡‘åŸºæ•°ä¸Šé™ï¼š</label>
    <input type="number" id="param_gjj_base_max" value="37302">
    <label>ç¤¾ä¿ä¸ªäººæ¯”ä¾‹ï¼ˆ%ï¼‰ï¼š</label>
    <input type="number" id="param_social_rate" value="10.5">
    <label>ç¤¾ä¿åŸºæ•°ä¸‹é™ï¼š</label>
    <input type="number" id="param_base_min" value="7460">
    <label>ç¤¾ä¿åŸºæ•°ä¸Šé™ï¼š</label>
    <input type="number" id="param_base_max" value="37302">
  </div>

  <div class="tabs">
    <div class="tab active" data-tool="gjj">ğŸ  å…¬ç§¯é‡‘</div>
    <div class="tab" data-tool="tax">ğŸ’° ä¸ªç¨</div>
    <div class="tab" data-tool="ylj">ğŸ‘´ å…»è€é‡‘</div>
  </div>
  
  <!-- å…¬ç§¯é‡‘ -->
  <div id="gjj" class="tool active">
    <h3>ä¸Šæµ·ä½æˆ¿å…¬ç§¯é‡‘ç´¯ç§¯è®¡ç®—å™¨ <span class="tip">(å¹´åˆ©ç‡ 1.5%)</span></h3>
    <label>æœˆå·¥èµ„ï¼ˆå…ƒï¼‰ï¼š</label>
    <input type="number" id="gjj_salary" placeholder="ç•™ç©ºç”¨å…¨å±€å·¥èµ„" step="50">
    <label>æœˆç¼´çº³é¢ï¼ˆå…ƒï¼‰ï¼š</label>
    <input type="number" id="gjj_month_amt">
    <label>ç¼´çº³å¹´æ•°ï¼š</label>
    <input type="number" id="gjj_years" value="1">
    <label>å½“å‰ä½™é¢ï¼ˆå…ƒï¼‰ï¼š</label>
    <input type="number" id="gjj_balance" value="0">
    <div class="result" id="gjj_result"></div>
  </div>
  
  <!-- ä¸ªç¨ -->
  <div id="tax" class="tool">
    <h3>ä¸Šæµ·å·¥èµ„ä¸ªç¨è®¡ç®—å™¨ <span class="tip">2025</span></h3>
    <label>æœˆå·¥èµ„ï¼ˆç¨å‰ï¼Œå…ƒï¼‰</label>
    <input type="number" id="tax_salary" placeholder="ç•™ç©ºç”¨å…¨å±€å·¥èµ„" step="50">
    <label>äº”é™©ä¸€é‡‘ï¼ˆå…ƒï¼‰</label>
    <input type="number" id="tax_insurance">
    <div class="tip">åŸºæ•°èŒƒå›´åŠæ¯”ä¾‹æ¥è‡ªå‚æ•°è®¾ç½®</div>
    <label>æœˆä¸“é¡¹é™„åŠ æ‰£é™¤ï¼ˆå…ƒï¼‰</label>
    <input type="number" id="tax_special" value="1000" step="1000">
    <label>å¹´ç»ˆå¥–ç³»æ•°ï¼ˆå€æœˆå·¥èµ„ï¼‰</label>
    <input type="number" id="tax_bonus_coef" value="4">
    <label>å¹´ç»ˆå¥–è®¡ç¨æ–¹å¼</label>
    <select id="tax_bonus_mode">
      <option value="alone">å•ç‹¬è®¡ç¨</option>
      <option value="merge">å¹¶å…¥å·¥èµ„</option>
    </select>
    <div class="result" id="tax_result"></div>
  </div>
  
  <!-- å…»è€é‡‘ -->
  <div id="ylj" class="tool">
    <h3>ä¸Šæµ·å…»è€é‡‘é¢„ä¼° <span class="tip">2025</span></h3>
    <label>æœˆå·¥èµ„ï¼ˆå…ƒï¼‰ï¼š</label>
    <input type="number" id="ylj_salary" placeholder="ç•™ç©ºç”¨å…¨å±€å·¥èµ„" step="50">
    <label>å·²ç¼´è´¹å¹´æ•°ï¼š</label>
    <input type="number" id="ylj_years_paid" value="0">
    <label>å·²ç¼´è´¹æœˆæ•°ï¼š</label>
    <input type="number" id="ylj_months_paid" value="0">
    <label>è®¡åˆ’æ€»ç¼´è´¹å¹´é™ï¼ˆå¹´ï¼‰ï¼š</label>
    <input type="number" id="ylj_plan" value="20">
    <label>å½“å‰ä¸ªäººè´¦æˆ·ä½™é¢ï¼ˆå…ƒï¼‰ï¼š</label>
    <input type="number" id="ylj_paid" value="85000">
    <label>æœ¬äººç¼´è´¹æŒ‡æ•°ï¼š</label>
    <input type="number" id="ylj_index" value="1.2" step="0.01">
    <label>é€€ä¼‘å¹´é¾„</label>
    <select id="ylj_age">
      <option value="60">60å²ï¼ˆç”·ï¼‰</option>
      <option value="55">55å²ï¼ˆå¥³å¹²éƒ¨ï¼‰</option>
      <option value="50">50å²ï¼ˆå¥³å·¥äººï¼‰</option>
    </select>
    <label>ä¸Šå¹´ç¤¾å¹³å·¥èµ„ï¼ˆå…ƒï¼‰</label>
    <input type="number" id="ylj_avg" value="12434">
    <div class="result" id="ylj_result"></div>
  </div>
</div>

<script>
// æ ‡ç­¾åˆ‡æ¢
document.querySelectorAll('.tab').forEach(t=>{
  t.onclick = ()=>{
    document.querySelectorAll('.tab').forEach(tt=>tt.classList.remove('active'));
    document.querySelectorAll('.tool').forEach(div=>div.classList.remove('active'));
    t.classList.add('active');
    document.getElementById(t.dataset.tool).classList.add('active');
  };
});

// å‚æ•°é¢æ¿å¼€å…³
document.getElementById('toggle-settings').onclick = ()=>{
  let sp=document.getElementById('settings-panel');
  if(sp.style.display==='none' || sp.style.display===''){
    sp.style.display='block';
    document.getElementById('toggle-settings').innerText='å…³é—­å‚æ•°è®¾ç½®';
  }else{
    sp.style.display='none';
    document.getElementById('toggle-settings').innerText='æ‰“å¼€å‚æ•°è®¾ç½®';
  }
};

// æ¸…ç©ºæ•°æ®æŒ‰é’®
document.getElementById('clear-data').onclick = ()=>{
  if(confirm('ç¡®å®šè¦æ¢å¤é»˜è®¤å€¼å¹¶æ¸…ç©ºæ‰€æœ‰ä¿å­˜çš„æ•°æ®å—ï¼Ÿ')){
    localStorage.removeItem('financeData');
    location.reload();
  }
};

// è·å–å·¥èµ„
function getSalary(id){
  let val = parseFloat(document.getElementById(id).value);
  if (isNaN(val) || val <= 0) {
    val = parseFloat(document.getElementById('global_salary').value);
  }
  return isNaN(val) ? 0 : val;
}

// å…¬ç§¯é‡‘è®¡ç®—
function computeGJJ(){
  let s=getSalary('gjj_salary');
  let rate=+document.getElementById('param_gjj_rate').value/100;
  let gjjBaseMin=+document.getElementById('param_gjj_base_min').value;
  let gjjBaseMax=+document.getElementById('param_gjj_base_max').value;
  let base=Math.max(gjjBaseMin, Math.min(s, gjjBaseMax));

  let mInput=document.getElementById('gjj_month_amt');
  if(!mInput.dataset.manual){
    mInput.value=(base*rate*2).toFixed(2);
  }
  let m=parseFloat(mInput.value)||0;
  let y=+document.getElementById('gjj_years').value;
  let b=+document.getElementById('gjj_balance').value;
  let r=0.015;
  let total=b*Math.pow(1+r,y)+m*12*(Math.pow(1+r,y)-1)/r;
  let paid=m*y*12;
  let interest=total-(b+paid);
  document.getElementById('gjj_result').innerHTML=`æœ€ç»ˆç´¯è®¡ï¼š<span class="sum">${total.toFixed(2)}</span> å…ƒ<br>æœŸé—´ç¼´çº³ï¼š${paid.toFixed(2)} å…ƒï¼Œåˆ©æ¯ï¼š${interest.toFixed(2)} å…ƒ`;
}
document.getElementById('gjj_month_amt').addEventListener('input',function(){
  this.dataset.manual=true;
});

// ä¸ªç¨è®¡ç®—ï¼ˆç•¥ï¼‰
const monthTable=[{up:3000,rate:0.03,quick:0},{up:12000,rate:0.1,quick:210},{up:25000,rate:0.2,quick:1410},{up:35000,rate:0.25,quick:2660},{up:55000,rate:0.3,quick:4410},{up:80000,rate:0.35,quick:7160},{up:Infinity,rate:0.45,quick:15160}];
const yearTable=[{up:36000,rate:0.03,quick:0},{up:144000,rate:0.1,quick:2520},{up:300000,rate:0.2,quick:16920},{up:420000,rate:0.25,quick:31920},{up:660000,rate:0.3,quick:52920},{up:960000,rate:0.35,quick:85920},{up:Infinity,rate:0.45,quick:181920}];
function getTaxTable(t,tb){for(let b of tb)if(t<=b.up)return b;}
function autoInsurance(){
  const minBase=+document.getElementById('param_base_min').value;
  const maxBase=+document.getElementById('param_base_max').value;
  const socialRate=+document.getElementById('param_social_rate').value/100;
  const gjjRate=+document.getElementById('param_gjj_rate').value/100;
  const gjjBaseMin=+document.getElementById('param_gjj_base_min').value;
  const gjjBaseMax=+document.getElementById('param_gjj_base_max').value;

  let s=getSalary('tax_salary');
  let socialBase=Math.max(minBase,Math.min(s,maxBase));
  let gjjBase=Math.max(gjjBaseMin,Math.min(s,gjjBaseMax));

  let social=socialBase*socialRate;
  let house=gjjBase*gjjRate;
  document.getElementById('tax_insurance').value=(social+house).toFixed(2);
}
function calcMonthTax(s,ins,special){let base=s-ins-special-5000;if(base<=0)return 0;let b=getTaxTable(base,monthTable);return base*b.rate-b.quick;}
function calcBonusTax(bonus){if(bonus<=0)return 0;let avg=bonus/12;let b=getTaxTable(avg,monthTable);return bonus*b.rate-b.quick;}
function calcMergeTax(s,ins,special,bonus){let total_income=s*12+bonus;let total_deduct=(ins+special+5000)*12;let taxable=total_income-total_deduct;if(taxable<=0)return 0;let b=getTaxTable(taxable,yearTable);return taxable*b.rate-b.quick;}
function computeTax(){
  let s=getSalary('tax_salary');
  let ins=parseFloat(document.getElementById('tax_insurance').value)||0;
  let special=+document.getElementById('tax_special').value;
  let coef=+document.getElementById('tax_bonus_coef').value;
  let bonus=s*coef;
  let mode=document.getElementById('tax_bonus_mode').value;
  let monthTax=calcMonthTax(s,ins,special);
  let afterMonth=s-ins-monthTax;
  let bonusTax=0;
  if(bonus>0){
    if(mode==='alone') bonusTax=calcBonusTax(bonus);
    else bonusTax=calcMergeTax(s,ins,special,bonus)-calcMergeTax(s,ins,special,0);
  }
  let afterBonus=bonus-bonusTax;
  document.getElementById('tax_result').innerHTML=`æœˆåˆ°æ‰‹ï¼š<span class="sum">${afterMonth.toFixed(2)}</span> å…ƒ<br>å¹´ç»ˆå¥–ï¼ˆ${coef}å€ï¼‰ï¼š${bonus.toFixed(2)} å…ƒï¼Œåˆ°æ‰‹ï¼š<span class="sum">${afterBonus.toFixed(2)}</span> å…ƒ<br>å…¨å¹´æ€»åˆ°æ‰‹ï¼š<span class="sum">${(afterMonth*12+afterBonus).toFixed(2)}</span> å…ƒ`;
}

// å…»è€é‡‘è®¡ç®—ï¼ˆæ–°ç‰ˆå…¬å¼ï¼‰
const monthMap={"50":195,"55":170,"60":139};
function computeYLJ(){
  let s=getSalary('ylj_salary');
  let avg=+document.getElementById('ylj_avg').value;
  let indexInput=document.getElementById('ylj_index');
  if(!indexInput.dataset.manual){
    indexInput.value=(s/avg).toFixed(2);
  }
  let index=parseFloat(indexInput.value)||0;
  let yearsPaid=+document.getElementById('ylj_years_paid').value;
  let monthsPaid=+document.getElementById('ylj_months_paid').value;
  let planYears=+document.getElementById('ylj_plan').value;
  let currentBalance=+document.getElementById('ylj_paid').value||0;

  // æœ¬äººç¼´è´¹åŸºæ•°
  let salary=index*avg;

  // å·²ç¼´è´¹æ€»å¹´é™
  let paidYearsTotal=yearsPaid + monthsPaid/12;

  // æœªæ¥ç¼´è´¹å¹´é™
  let futureYears=planYears - paidYearsTotal;
  if(futureYears<0) futureYears=0;

  // æœªæ¥ç¼´çº³é¢
  let futureAmount=futureYears*12*salary*0.08;

  // é€€ä¼‘æ—¶ä¸ªäººè´¦æˆ·æ€»é¢
  let totalAccount=currentBalance + futureAmount;

  // åŸºç¡€å…»è€é‡‘
  let basePension=((avg+salary)/2) * (paidYearsTotal*0.01);

  // ä¸ªäººè´¦æˆ·å…»è€é‡‘
  let personalPension=totalAccount / monthMap[document.getElementById('ylj_age').value];

  // æ€»å…»è€é‡‘
  let totalPension=basePension + personalPension;

  document.getElementById('ylj_result').innerHTML=
    `é¢„ä¼°å…»è€é‡‘ï¼ˆæœˆï¼‰ï¼š<span class="sum">${totalPension.toFixed(2)}</span> å…ƒ<br>`+
    `åŸºç¡€å…»è€é‡‘ï¼š${basePension.toFixed(2)} å…ƒ<br>`+
    `ä¸ªäººè´¦æˆ·å…»è€é‡‘ï¼š${personalPension.toFixed(2)} å…ƒ<br>`+
    `æœªæ¥ç¼´è´¹é¢ï¼š${futureAmount.toFixed(2)} å…ƒ<br>`+
    `æ€»ç¼´è´¹å¹´é™ï¼š${(paidYearsTotal+futureYears).toFixed(2)} å¹´<br>`+
    `é€€ä¼‘æ—¶ä¸ªäººè´¦æˆ·æ€»é¢ï¼š${totalAccount.toFixed(2)} å…ƒ`;
}
document.getElementById('ylj_index').addEventListener('input',function(){this.dataset.manual=true;});

// ä¿å­˜ä¸åŠ è½½
function saveInputs(){let data={};document.querySelectorAll('input,select').forEach(el=>{data[el.id]=el.value;});localStorage.setItem('financeData',JSON.stringify(data));}
function loadInputs(){let data=localStorage.getItem('financeData');if(data){try{data=JSON.parse(data);for(let id in data){if(document.getElementById(id)){document.getElementById(id).value=data[id];}}}catch(e){}}}
function triggerAll(){autoInsurance();computeGJJ();computeTax();computeYLJ();saveInputs();}
document.querySelectorAll('input,select').forEach(el=>{el.addEventListener('input',triggerAll);el.addEventListener('change',triggerAll);});
loadInputs();
triggerAll();
</script>
</body>
</html>
